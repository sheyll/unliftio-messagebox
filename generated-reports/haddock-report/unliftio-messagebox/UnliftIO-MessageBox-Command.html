<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>UnliftIO.MessageBox.Command</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">unliftio-messagebox-2.1.0: Fast and robust message queues for concurrent processes</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">UnliftIO.MessageBox.Command</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Abstractions for the definition of
 <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> <code>Messages</code>, that flow between</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Message">Message</a> apiTag <span class="keyword">where</span><ul class="subs"><li><a href="#v:Blocking">Blocking</a> :: Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result)) =&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a> result -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag</li><li><a href="#v:NonBlocking">NonBlocking</a> :: Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag '<a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a>) =&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag '<a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag</li></ul></li><li class="src short"><span class="keyword">data family</span> <a href="#t:Command">Command</a> apiTag :: <a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a> -&gt; Type</li><li class="src short"><span class="keyword">data</span> <a href="#t:ReturnType">ReturnType</a> <span class="keyword">where</span><ul class="subs"><li><a href="#v:FireAndForget">FireAndForget</a> :: <a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a></li><li><a href="#v:Return">Return</a> :: Type -&gt; <a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:ReplyBox">ReplyBox</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:CommandError">CommandError</a> <span class="keyword">where</span><ul class="subs"><li><a href="#v:CouldNotEnqueueCommand">CouldNotEnqueueCommand</a> :: !<a href="UnliftIO-MessageBox-Util-CallId.html#t:CallId" title="UnliftIO.MessageBox.Util.CallId">CallId</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a></li><li><a href="#v:BlockingCommandFailure">BlockingCommandFailure</a> :: !<a href="UnliftIO-MessageBox-Util-CallId.html#t:CallId" title="UnliftIO.MessageBox.Util.CallId">CallId</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a></li><li><a href="#v:BlockingCommandTimedOut">BlockingCommandTimedOut</a> :: !<a href="UnliftIO-MessageBox-Util-CallId.html#t:CallId" title="UnliftIO.MessageBox.Util.CallId">CallId</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a></li></ul></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:DuplicateReply">DuplicateReply</a> = <a href="#v:DuplicateReply">DuplicateReply</a> <a href="UnliftIO-MessageBox-Util-CallId.html#t:CallId" title="UnliftIO.MessageBox.Util.CallId">CallId</a></li><li class="src short"><a href="#v:cast">cast</a> :: (MonadUnliftIO m, <a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a> o, Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag '<a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a>)) =&gt; o (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag '<a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a> -&gt; m Bool</li><li class="src short"><a href="#v:call">call</a> :: (<a href="UnliftIO-MessageBox-Util-CallId.html#t:HasCallIdCounter" title="UnliftIO.MessageBox.Util.CallId">HasCallIdCounter</a> env, MonadReader env m, MonadUnliftIO m, <a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a> input, Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result))) =&gt; input (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result) -&gt; Int -&gt; m (Either <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> result)</li><li class="src short"><a href="#v:replyTo">replyTo</a> :: MonadUnliftIO m =&gt; <a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a> a -&gt; a -&gt; m ()</li><li class="src short"><a href="#v:callAsync">callAsync</a> :: (<a href="UnliftIO-MessageBox-Util-CallId.html#t:HasCallIdCounter" title="UnliftIO.MessageBox.Util.CallId">HasCallIdCounter</a> env, MonadReader env m, MonadUnliftIO m, <a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a> o, Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result))) =&gt; o (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result) -&gt; m (Maybe (<a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> result))</li><li class="src short"><a href="#v:delegateCall">delegateCall</a> :: (MonadUnliftIO m, <a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a> o, Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> r))) =&gt; o (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> r) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a> r -&gt; m Bool</li><li class="src short"><span class="keyword">data</span> <a href="#t:AsyncReply">AsyncReply</a> r</li><li class="src short"><a href="#v:waitForReply">waitForReply</a> :: MonadUnliftIO m =&gt; Int -&gt; <a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> result -&gt; m (Either <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> result)</li><li class="src short"><a href="#v:tryTakeReply">tryTakeReply</a> :: MonadUnliftIO m =&gt; <a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> result -&gt; m (Maybe (Either <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> result))</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Message" class="def">Message</a> apiTag <span class="keyword">where</span> <a href="#t:Message" class="selflink">#</a></p><div class="doc"><p>A message valid for some user defined <code>apiTag</code>.</p><p>The <code>apiTag</code> tag (phantom-) type defines the
 messages allowed here, declared by the instance of
 <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> for <code>apiTag</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Blocking" class="def">Blocking</a> :: Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result)) =&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a> result -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag</td><td class="doc"><p>Wraps a <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> with a <code><a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a></code> of <code><a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a></code> <code>result</code>.</p><p>Such a message can formed by using <code><a href="UnliftIO-MessageBox-Command.html#v:call" title="UnliftIO.MessageBox.Command">call</a></code>.</p><p>A <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code> contains a <code><a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a></code> that can be
 used to send the reply to the other process
 blocking on <code><a href="UnliftIO-MessageBox-Command.html#v:call" title="UnliftIO.MessageBox.Command">call</a></code></p></td></tr><tr><td class="src"><a id="v:NonBlocking" class="def">NonBlocking</a> :: Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag '<a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a>) =&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag '<a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag</td><td class="doc"><p>If the <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> has a <code><a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a></code> of <code><a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a></code>
 it has fire-and-forget semantics.</p><p>The smart constructor <code><a href="UnliftIO-MessageBox-Command.html#v:cast" title="UnliftIO.MessageBox.Command">cast</a></code> can be used to
 this message.</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Message">Instances</h4><details id="i:Message" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Message:Show:1"></span> Show (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag)</span> <a href="#t:Message" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Message:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="UnliftIO-MessageBox-Command.html">UnliftIO.MessageBox.Command</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data family</span> <a id="t:Command" class="def">Command</a> apiTag :: <a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a> -&gt; Type <a href="#t:Command" class="selflink">#</a></p><div class="doc"><p>This family allows to encode imperative <em>commands</em>.</p><p>The clauses of a <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> define the commands that
 a process should execute.</p><p>Every clause may specify an individual <code><a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a></code> that
 declares if and what response is valid for a message.</p><p>For example:</p><pre>
type LampId = Int

data instance Command LightControl r where
  GetLamps :: Command LigthControl (Return [LampId])
  SwitchOn :: LampId -&gt; Command LigthControl FireAndForget

data LightControl -- the phantom type
</pre><p>The type index of the Command family is the uninhabited
 <code>LightControl</code> type.
 .</p><p>The second type parameter indicates if a message requires the
 receiver to send a reply back to the blocked and waiting
 sender, or if no reply is necessary.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ReturnType" class="def">ReturnType</a> <span class="keyword">where</span> <a href="#t:ReturnType" class="selflink">#</a></p><div class="doc"><p>Indicates if a <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> requires the
 receiver to send a reply or not.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:FireAndForget" class="def">FireAndForget</a> :: <a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a></td><td class="doc"><p>Indicates that a <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> value is sent _one-way_.</p><p>Values of a <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> instance with <code><a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a></code> as second
 parameter indicate that the sender should not expect any direct
 answer from the recepient.</p></td></tr><tr><td class="src"><a id="v:Return" class="def">Return</a> :: Type -&gt; <a href="UnliftIO-MessageBox-Command.html#t:ReturnType" title="UnliftIO.MessageBox.Command">ReturnType</a></td><td class="doc"><p>Indicates that a <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> value requires the receiver
 to send a reply of the given type.</p><p>Values of a <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> instance with <code><a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a></code> as second parameter
 are received wrapped into a <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code>.</p></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ReplyBox" class="def">ReplyBox</a> a <a href="#t:ReplyBox" class="selflink">#</a></p><div class="doc"><p>This is like <code>Input</code>, it can be used
 by the receiver of a <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code>
 to either send a reply using <code>reply</code>
 or to fail/abort the request using <code>sendRequestError</code></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:CommandError" class="def">CommandError</a> <span class="keyword">where</span> <a href="#t:CommandError" class="selflink">#</a></p><div class="doc"><p>The failures that the receiver of a <code><a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code>, i.e. a <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code>,
 can communicate to the <em>caller</em>, in order to indicate that
 processing a request did not or will not lead to the result the
 caller is blocked waiting for.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CouldNotEnqueueCommand" class="def">CouldNotEnqueueCommand</a> :: !<a href="UnliftIO-MessageBox-Util-CallId.html#t:CallId" title="UnliftIO.MessageBox.Util.CallId">CallId</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a></td><td class="doc"><p>Failed to enqueue a <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a></code> into the corresponding
 <code><a href="UnliftIO-MessageBox-Class.html#t:Input" title="UnliftIO.MessageBox.Class">Input</a></code></p></td></tr><tr><td class="src"><a id="v:BlockingCommandFailure" class="def">BlockingCommandFailure</a> :: !<a href="UnliftIO-MessageBox-Util-CallId.html#t:CallId" title="UnliftIO.MessageBox.Util.CallId">CallId</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a></td><td class="doc"><p>The request has failed <em>for reasons</em>.</p></td></tr><tr><td class="src"><a id="v:BlockingCommandTimedOut" class="def">BlockingCommandTimedOut</a> :: !<a href="UnliftIO-MessageBox-Util-CallId.html#t:CallId" title="UnliftIO.MessageBox.Util.CallId">CallId</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a></td><td class="doc"><p>Timeout waiting for the result.</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:CommandError">Instances</h4><details id="i:CommandError" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CommandError:Eq:1"></span> Eq <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a></span> <a href="#t:CommandError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CommandError:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="UnliftIO-MessageBox-Command.html">UnliftIO.MessageBox.Command</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CommandError:Show:2"></span> Show <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a></span> <a href="#t:CommandError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CommandError:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="UnliftIO-MessageBox-Command.html">UnliftIO.MessageBox.Command</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:DuplicateReply" class="def">DuplicateReply</a> <a href="#t:DuplicateReply" class="selflink">#</a></p><div class="doc"><p>Exception thrown by <code><a href="UnliftIO-MessageBox-Command.html#v:replyTo" title="UnliftIO.MessageBox.Command">replyTo</a></code> when <code><a href="UnliftIO-MessageBox-Command.html#v:replyTo" title="UnliftIO.MessageBox.Command">replyTo</a></code> is call more than once.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DuplicateReply" class="def">DuplicateReply</a> <a href="UnliftIO-MessageBox-Util-CallId.html#t:CallId" title="UnliftIO.MessageBox.Util.CallId">CallId</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:DuplicateReply">Instances</h4><details id="i:DuplicateReply" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DuplicateReply:Eq:1"></span> Eq <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a></span> <a href="#t:DuplicateReply" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DuplicateReply:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="UnliftIO-MessageBox-Command.html">UnliftIO.MessageBox.Command</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a> -&gt; <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DuplicateReply:Show:2"></span> Show <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a></span> <a href="#t:DuplicateReply" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DuplicateReply:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="UnliftIO-MessageBox-Command.html">UnliftIO.MessageBox.Command</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DuplicateReply:Exception:3"></span> Exception <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a></span> <a href="#t:DuplicateReply" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DuplicateReply:Exception:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="UnliftIO-MessageBox-Command.html">UnliftIO.MessageBox.Command</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toException">toException</a> :: <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a> -&gt; SomeException</p><p class="src"><a href="#v:fromException">fromException</a> :: SomeException -&gt; Maybe <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a></p><p class="src"><a href="#v:displayException">displayException</a> :: <a href="UnliftIO-MessageBox-Command.html#t:DuplicateReply" title="UnliftIO.MessageBox.Command">DuplicateReply</a> -&gt; String</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:cast" class="def">cast</a> :: (MonadUnliftIO m, <a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a> o, Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag '<a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a>)) =&gt; o (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag '<a href="UnliftIO-MessageBox-Command.html#v:FireAndForget" title="UnliftIO.MessageBox.Command">FireAndForget</a> -&gt; m Bool <a href="#v:cast" class="selflink">#</a></p><div class="doc"><p>Enqueue a <code><a href="UnliftIO-MessageBox-Command.html#v:NonBlocking" title="UnliftIO.MessageBox.Command">NonBlocking</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a></code> into an <code>Input</code>.
 This is just for symetry to <code><a href="UnliftIO-MessageBox-Command.html#v:call" title="UnliftIO.MessageBox.Command">call</a></code>, this is
 equivalent to: <code>input -&gt; MessageBox.tryToDeliver input . NonBlocking</code></p><p>The</p></div></div><div class="top"><p class="src"><a id="v:call" class="def">call</a> :: (<a href="UnliftIO-MessageBox-Util-CallId.html#t:HasCallIdCounter" title="UnliftIO.MessageBox.Util.CallId">HasCallIdCounter</a> env, MonadReader env m, MonadUnliftIO m, <a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a> input, Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result))) =&gt; input (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result) -&gt; Int -&gt; m (Either <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> result) <a href="#v:call" class="selflink">#</a></p><div class="doc"><p>Enqueue a <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a></code> into an <code><a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a></code> and wait for the
 response.</p><p>If message <code>deliver</code>y failed, return <code>Left <code><a href="UnliftIO-MessageBox-Command.html#v:CouldNotEnqueueCommand" title="UnliftIO.MessageBox.Command">CouldNotEnqueueCommand</a></code></code>.</p><p>If no reply was given by the receiving process (using <code><a href="UnliftIO-MessageBox-Command.html#v:replyTo" title="UnliftIO.MessageBox.Command">replyTo</a></code>) within
 a given duration, return <code>Left <code><a href="UnliftIO-MessageBox-Command.html#v:BlockingCommandTimedOut" title="UnliftIO.MessageBox.Command">BlockingCommandTimedOut</a></code></code>.</p><p>Important: The given timeout starts <strong>after</strong> <code>deliver</code> has returned,
 if <code>deliver</code> blocks and delays, <code><a href="UnliftIO-MessageBox-Command.html#v:call" title="UnliftIO.MessageBox.Command">call</a></code> might take longer than the
 specified timeout.</p><p>The receiving process can either delegate the call using
 <code><a href="UnliftIO-MessageBox-Command.html#v:delegateCall" title="UnliftIO.MessageBox.Command">delegateCall</a></code> or reply to the call by using: <code><a href="UnliftIO-MessageBox-Command.html#v:replyTo" title="UnliftIO.MessageBox.Command">replyTo</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:replyTo" class="def">replyTo</a> :: MonadUnliftIO m =&gt; <a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a> a -&gt; a -&gt; m () <a href="#v:replyTo" class="selflink">#</a></p><div class="doc"><p>This is called from the callback contained in the <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a></code>.</p><p>When handling a <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a></code> the <code><a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a></code> contained
 in the message contains the <code>TMVar</code> for the result, and this
 function puts the result into it.</p></div></div><div class="top"><p class="src"><a id="v:callAsync" class="def">callAsync</a> :: (<a href="UnliftIO-MessageBox-Util-CallId.html#t:HasCallIdCounter" title="UnliftIO.MessageBox.Util.CallId">HasCallIdCounter</a> env, MonadReader env m, MonadUnliftIO m, <a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a> o, Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result))) =&gt; o (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> result) -&gt; m (Maybe (<a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> result)) <a href="#v:callAsync" class="selflink">#</a></p><div class="doc"><p>Enqueue a <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a></code> into an <code><a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a></code>.</p><p>If the call to <code>deliver</code> fails, return <code>Nothing</code> otherwise
 <code>Just</code> the <code><a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a></code>.</p><p>The receiving process must use <code><a href="UnliftIO-MessageBox-Command.html#v:replyTo" title="UnliftIO.MessageBox.Command">replyTo</a></code>  with the <code><a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a></code>
 received along side the <code><a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a></code> in the <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:delegateCall" class="def">delegateCall</a> :: (MonadUnliftIO m, <a href="UnliftIO-MessageBox-Class.html#t:IsInput" title="UnliftIO.MessageBox.Class">IsInput</a> o, Show (<a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> r))) =&gt; o (<a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a> apiTag) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:Command" title="UnliftIO.MessageBox.Command">Command</a> apiTag ('<a href="UnliftIO-MessageBox-Command.html#v:Return" title="UnliftIO.MessageBox.Command">Return</a> r) -&gt; <a href="UnliftIO-MessageBox-Command.html#t:ReplyBox" title="UnliftIO.MessageBox.Command">ReplyBox</a> r -&gt; m Bool <a href="#v:delegateCall" class="selflink">#</a></p><div class="doc"><p>Pass on the call to another process.</p><p>Used to implement dispatcher processes.</p><p>Returns <code>True</code> if the <code><a href="UnliftIO-MessageBox-Class.html#v:deliver" title="UnliftIO.MessageBox.Class">deliver</a></code> operation was
 successful.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:AsyncReply" class="def">AsyncReply</a> r <a href="#t:AsyncReply" class="selflink">#</a></p><div class="doc"><p>The result of <code><a href="UnliftIO-MessageBox-Command.html#v:callAsync" title="UnliftIO.MessageBox.Command">callAsync</a></code>.
 Use <code><a href="UnliftIO-MessageBox-Command.html#v:waitForReply" title="UnliftIO.MessageBox.Command">waitForReply</a></code> or <code><a href="UnliftIO-MessageBox-Command.html#v:tryTakeReply" title="UnliftIO.MessageBox.Command">tryTakeReply</a></code>.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:AsyncReply">Instances</h4><details id="i:AsyncReply" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:AsyncReply:Show:1"></span> Typeable r =&gt; Show (<a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> r)</span> <a href="#t:AsyncReply" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:AsyncReply:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="UnliftIO-MessageBox-Command.html">UnliftIO.MessageBox.Command</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> r -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> r -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> r] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:waitForReply" class="def">waitForReply</a> <a href="#v:waitForReply" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: MonadUnliftIO m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; Int</td><td class="doc"><p>The time in micro seconds to wait
 before returning <code>Left</code> <code><a href="UnliftIO-MessageBox-Command.html#v:BlockingCommandTimedOut" title="UnliftIO.MessageBox.Command">BlockingCommandTimedOut</a></code></p></td></tr><tr><td class="src">-&gt; <a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> result</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; m (Either <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> result)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Wait for the reply of a <code><a href="UnliftIO-MessageBox-Command.html#v:Blocking" title="UnliftIO.MessageBox.Command">Blocking</a></code> <code><a href="UnliftIO-MessageBox-Command.html#t:Message" title="UnliftIO.MessageBox.Command">Message</a></code>
 sent by <code><a href="UnliftIO-MessageBox-Command.html#v:callAsync" title="UnliftIO.MessageBox.Command">callAsync</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:tryTakeReply" class="def">tryTakeReply</a> :: MonadUnliftIO m =&gt; <a href="UnliftIO-MessageBox-Command.html#t:AsyncReply" title="UnliftIO.MessageBox.Command">AsyncReply</a> result -&gt; m (Maybe (Either <a href="UnliftIO-MessageBox-Command.html#t:CommandError" title="UnliftIO.MessageBox.Command">CommandError</a> result)) <a href="#v:tryTakeReply" class="selflink">#</a></p><div class="doc"><p>If a reply for an <code><a href="UnliftIO-MessageBox-Command.html#v:callAsync" title="UnliftIO.MessageBox.Command">callAsync</a></code> operation is available
 return it, otherwise return <code>Nothing</code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>